---
phase: 03-wallet-integration
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - front-end/src/components/wallet/devnet-wallet-selector.tsx
  - front-end/src/components/wallet/connect-button.tsx
  - front-end/src/components/wallet/wallet-dropdown.tsx
autonomous: true

must_haves:
  truths:
    - "Devnet wallet selector shows 6 test wallets in dropdown"
    - "Connect button triggers Leather extension on testnet/mainnet"
    - "Connect button shows devnet selector on devnet"
    - "Connected wallet shows truncated address with dropdown menu"
    - "Dropdown shows full address with copy and disconnect options"
  artifacts:
    - path: "front-end/src/components/wallet/devnet-wallet-selector.tsx"
      provides: "Devnet wallet selection dropdown"
      exports: ["DevnetWalletSelector"]
      min_lines: 30
    - path: "front-end/src/components/wallet/connect-button.tsx"
      provides: "Network-aware connect button"
      exports: ["ConnectButton"]
      min_lines: 25
    - path: "front-end/src/components/wallet/wallet-dropdown.tsx"
      provides: "Connected wallet dropdown with address and disconnect"
      exports: ["WalletDropdown"]
      min_lines: 40
  key_links:
    - from: "connect-button.tsx"
      to: "wallet-provider.tsx"
      via: "useWallet hook"
      pattern: "useWallet"
    - from: "connect-button.tsx"
      to: "devnet-wallet-selector.tsx"
      via: "DevnetWalletSelector import"
      pattern: "DevnetWalletSelector"
    - from: "wallet-dropdown.tsx"
      to: "formatStxAddress"
      via: "address truncation"
      pattern: "formatStxAddress"
    - from: "wallet-dropdown.tsx"
      to: "navigator.clipboard"
      via: "copy address functionality"
      pattern: "navigator\\.clipboard\\.writeText"
---

<objective>
Create wallet UI components: devnet selector dropdown, network-aware connect button, and connected wallet dropdown.

Purpose: These components provide the user interface for wallet connection and management, used in the Navbar.

Output: Three wallet components ready for integration into Navbar.
</objective>

<execution_context>
@/Users/kenny/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kenny/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-wallet-integration/03-RESEARCH.md
@.planning/phases/03-wallet-integration/03-CONTEXT.md
@.planning/phases/03-wallet-integration/03-01-SUMMARY.md

# Components to use
@front-end/src/components/ui/button.tsx
@front-end/src/components/ui/dropdown-menu.tsx

# Utilities and types
@front-end/src/lib/address-utils.ts
@front-end/src/lib/devnet-wallet-context.ts

# Reference implementations
@front-end/src/components/_deprecated-chakra/DevnetWalletButton.tsx
@front-end/src/components/_deprecated-chakra/ConnectWallet.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create DevnetWalletSelector component</name>
  <files>front-end/src/components/wallet/devnet-wallet-selector.tsx</files>
  <action>
Create dropdown component for selecting devnet test wallets.

**Requirements:**

1. Add "use client" directive

2. Import dependencies:
   - DropdownMenu components from @/components/ui/dropdown-menu
   - Button from @/components/ui/button
   - devnetWallets from @/lib/devnet-wallet-context
   - useWallet from @/components/providers/wallet-provider
   - formatStxAddress from @/lib/address-utils

3. Component structure:
```tsx
export function DevnetWalletSelector() {
  const { devnetWallet, setDevnetWallet } = useWallet()

  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="outline">
          {devnetWallet ? formatStxAddress(devnetWallet.stxAddress) : "Select Wallet"}
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent align="end">
        {devnetWallets.map((wallet) => (
          <DropdownMenuItem
            key={wallet.stxAddress}
            onClick={() => setDevnetWallet(wallet)}
          >
            <div className="flex flex-col">
              <span className="font-medium">{wallet.label}</span>
              <span className="font-mono text-xs text-muted-foreground">
                {formatStxAddress(wallet.stxAddress)}
              </span>
            </div>
          </DropdownMenuItem>
        ))}
      </DropdownMenuContent>
    </DropdownMenu>
  )
}
```

4. Style selected wallet differently (visual feedback for current selection)

**Create directory first:** `mkdir -p front-end/src/components/wallet`
  </action>
  <verify>
```bash
cd front-end && pnpm tsc --noEmit
```
File exists at front-end/src/components/wallet/devnet-wallet-selector.tsx
  </verify>
  <done>
DevnetWalletSelector component created. Shows 6 devnet wallets in dropdown. Selected wallet shown in trigger button. TypeScript compiles.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ConnectButton component</name>
  <files>front-end/src/components/wallet/connect-button.tsx</files>
  <action>
Create network-aware connect button that shows Leather prompt or devnet selector.

**Requirements:**

1. Add "use client" directive

2. Import dependencies:
   - Button from @/components/ui/button
   - useWallet from @/components/providers/wallet-provider
   - DevnetWalletSelector from ./devnet-wallet-selector

3. Component logic:
```tsx
export function ConnectButton() {
  const { isDevnet, isConnecting, connectWallet } = useWallet()

  // On devnet, show wallet selector instead of connect button
  if (isDevnet) {
    return <DevnetWalletSelector />
  }

  // On testnet/mainnet, show Leather connect button
  return (
    <Button
      variant="outline"
      onClick={connectWallet}
      disabled={isConnecting}
    >
      {isConnecting ? "Connecting..." : "Connect Wallet"}
    </Button>
  )
}
```

4. Handle case where Leather extension not installed:
   - Check `typeof window !== 'undefined' && window.LeatherProvider` before showing connect
   - If not installed, button could show "Install Leather" and open leather.io/install
   - This is optional enhancement; basic flow assumes extension installed
  </action>
  <verify>
```bash
cd front-end && pnpm tsc --noEmit
```
File exists at front-end/src/components/wallet/connect-button.tsx
  </verify>
  <done>
ConnectButton component created. Shows DevnetWalletSelector on devnet. Shows Leather connect button on testnet/mainnet with loading state. TypeScript compiles.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create WalletDropdown component</name>
  <files>front-end/src/components/wallet/wallet-dropdown.tsx</files>
  <action>
Create dropdown for connected wallet showing full address, copy, and disconnect.

**Requirements:**

1. Add "use client" directive

2. Import dependencies:
   - Button from @/components/ui/button
   - DropdownMenu components from @/components/ui/dropdown-menu
   - useWallet from @/components/providers/wallet-provider
   - formatStxAddress from @/lib/address-utils
   - toast from sonner
   - Copy, LogOut icons from lucide-react

3. Component structure:
```tsx
export function WalletDropdown() {
  const { address, disconnectWallet } = useWallet()

  const copyAddress = async () => {
    if (!address) return
    try {
      await navigator.clipboard.writeText(address)
      toast.success("Address copied to clipboard")
    } catch {
      toast.error("Failed to copy address")
    }
  }

  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="outline">
          {formatStxAddress(address || "")}
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent align="end" className="w-64">
        <DropdownMenuItem onClick={copyAddress}>
          <Copy className="mr-2 size-4" />
          <span className="font-mono text-xs truncate">{address}</span>
        </DropdownMenuItem>
        <DropdownMenuSeparator />
        <DropdownMenuItem onClick={disconnectWallet}>
          <LogOut className="mr-2 size-4" />
          Disconnect
        </DropdownMenuItem>
      </DropdownMenuContent>
    </DropdownMenu>
  )
}
```

4. Import DropdownMenuSeparator for visual separation between copy and disconnect

5. Full address shown in copy menu item (font-mono, truncate with CSS if too long)

6. Use toast.success/error for clipboard feedback (Sonner already configured)
  </action>
  <verify>
```bash
cd front-end && pnpm tsc --noEmit
```
File exists at front-end/src/components/wallet/wallet-dropdown.tsx
  </verify>
  <done>
WalletDropdown component created. Shows truncated address in trigger. Dropdown shows full address with copy button (uses Sonner toast for feedback) and disconnect option. TypeScript compiles.
  </done>
</task>

</tasks>

<verification>
After all tasks:
1. `pnpm tsc --noEmit` passes
2. Three files exist in front-end/src/components/wallet/
3. All components use useWallet hook
4. DevnetWalletSelector shows 6 wallets
5. ConnectButton conditionally renders based on network
6. WalletDropdown has copy and disconnect functionality
</verification>

<success_criteria>
- wallet/ directory created with 3 component files
- DevnetWalletSelector renders dropdown with 6 wallets from devnetWallets
- ConnectButton shows DevnetWalletSelector on devnet, Leather button on testnet/mainnet
- WalletDropdown shows truncated address, copy with toast, disconnect
- All components are client components ("use client")
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/03-wallet-integration/03-02-SUMMARY.md`
</output>
